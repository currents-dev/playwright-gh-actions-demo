name: demo.playwright.pwc
on:
  workflow_dispatch:
  pull_request:
    branches: [main]
  push:
    branches: [main]
jobs:
  basicTests:
    strategy:
      fail-fast: false
      matrix:
        # run 3 copies of the job in parallel
        shard: [1]

    name: "Playwright Tests - pwc"
    timeout-minutes: 60
    runs-on: ubuntu-22.04
    container: mcr.microsoft.com/playwright:latest

    steps:
      # - uses: actions/checkout@v4
      #   with:
      #     ref: ${{ github.event.pull_request.head.sha }}

      # https://github.com/actions/runner-images/issues/6775
      - run: |
          echo "$GITHUB_WORKSPACE"
          git config --global --add safe.directory "$GITHUB_WORKSPACE"

      # Dump the GitHub context
      - name: Dump GitHub Context
        run:
          echo '${{ toJson(github) }}'

          # Dump Environment variables
      - name: Dump Env Vars
        run: |
          printenv  | grep -v "SECRET" | sort

      # Dump Environment variables
      - name: Dump Env Context
        run: |
          echo '${{ toJson(env) }}'

      - name: Dump Strategy Context
        run: |
          echo '${{ toJson(strategy) }}'

      - name: Dump vars Context
        run: |
          echo '${{ toJson(vars) }}'

      - name: Dump needs Context
        run: |
          echo '${{ toJson(needs) }}'

      - name: Dump needs Context
        run: |
          echo '${{ toJson(inputs) }}'

      # Dump Job Context
      - name: Dump Job Context
        run: echo '${{ toJson(job) }}'

      # Dump Runner Context
      - name: Dump Runner Context
        run: echo '${{ toJson(runner) }}'

      # Dump Steps Context
      - name: Dump Steps Context
        run: echo '${{ toJson(steps) }}'

      # Dump Secrets (only keys, not values, for security reasons)
      - name: List Secrets Keys
        run: echo '${{ toJson(secrets) }}'

      # Dump Matrix Context (if matrix is used)
      - name: Dump Matrix Context
        if: ${{ matrix }}
        run: echo '${{ toJson(matrix) }}'

      # - uses: actions/setup-node@v4
      #   with:
      #     node-version: "20.x"

      # - name: Install dependencies
      #   run: |
      #     npm ci
      #     npx playwright install chrome

      # - name: Playwright Tests
      #   continue-on-error: false
      #   working-directory: ./basic
      #   env:
      #     CURRENTS_PROJECT_ID: bnsqNa
      #     CURRENTS_RECORD_KEY: ${{ secrets.CURRENTS_RECORD_KEY }}
      #   run: |
      #     npx pwc --shard=${{ matrix.shard }}/${{ strategy.job-total }}
